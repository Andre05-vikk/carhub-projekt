{% extends 'pages/base.html' %}
{% block title %} | Cars {% endblock %}
{% block content %}

{% load humanize %}
{% load static %}

<div class="sub-banner overview-bgi">
    <div class="container breadcrumb-area">
        <div class="breadcrumb-areas">
            <h1>Our Cars</h1>
            <ul class="breadcrumbs">
                <li><a href="{% url 'home' %}">Home</a></li>
                <li class="active">Cars</li>
            </ul>
        </div>
    </div>
</div>
<!-- Sub Banner end -->

<!-- Cars Listing start -->
<div class="cars-listing content-area-5">
    <div class="container">
        <div class="row">
            <!-- Left Column: Cars Listing -->
            <div class="col-lg-8">
                <div class="row">
                    {% for car in cars %}
                    <div class="slick-slide-item">
                        <div class="car-box-3">
                            <div class="car-thumbnail">
                                <a href="{% url 'car_detail' car.id %}" class="car-img">
                                    <div class="tag-2" style="background-color: red; color: white;">For Sale</div>
                                    <div class="price-box">
                                        <br>
                                        <span>${{ car.price | intcomma }}</span>
                                    </div>
                                    <img class="d-block w-100" src="{{ car.car_photo.url }}" alt="car" style="min-height: 240px; max-height: 240px;">
                                </a>
                            </div>

                            <!-- Car details -->
                            <div class="detail">
                                <h1 class="title">
                                    <a href="{% url 'car_detail' car.id %}">{{ car.year }} {{ car.car_title }} {{ car.model }}</a>
                                </h1>
                                <div class="location">
                                    <a href="{% url 'car_detail' car.id %}">
                                        <i class="flaticon-pin"></i>{{ car.city }}, {{ car.state }}
                                    </a>
                                </div>
                                <ul class="facilities-list clearfix">
                                    <li>{{ car.fuel_type }}</li>
                                    <li>{{ car.miles | intcomma }}</li>
                                    <li>{{ car.transmission }}</li>
                                    <li>{{ car.body_style }}</li>
                                    <li>{{ car.color }}</li>
                                    <li>{{ car.year }}</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    {% empty %}
                    <p class="text-center w-100">No cars available at the moment.</p>
                    {% endfor %}
                </div>
            </div>

            <!-- Right Column: Search Filters -->
            <div class="col-lg-4">
                <div class="search-filter p-4 bg-light rounded">
                    <h5>Search for your desired car</h5>
                    <!-- Form for search filters -->
                    <form method="get" action="{% url 'search' %}">
                        <!-- Search by car title -->
                        <input type="text" name="search" class="form-control mb-3" placeholder="Search by name" value="{{ request.GET.search }}">

                        <!-- Brand filter dropdown -->
                        <select name="car_title" class="form-control mb-3" id="brand" style="background-color: white;">
                            <option value="">Select Brand</option>
                            {% for car in car_title_search %}
                            <option value="{{ car }}" {% if car == request.GET.car_title %}selected{% endif %}>{{ car }}</option>
                            {% endfor %}
                        </select>

                        <!-- Model filter dropdown -->
                        <select name="model" class="form-control mb-3" id="model" style="background-color: white;">
                            <option value="">Select Model</option>
                            {% for model in model_search %}
                            <option value="{{ model }}" {% if model == request.GET.model %}selected{% endif %}>{{ model }}</option>
                            {% endfor %}
                        </select>

                        <!-- Location filter dropdown -->
                        <select name="location" class="form-control mb-3" id="state" style="background-color: white;">
                            <option value="">Select State</option>
                            {% for state in state_search %}
                            <option value="{{ state }}" {% if state == request.GET.location %}selected{% endif %}>{{ state }}</option>
                            {% endfor %}
                        </select>

                        <!-- Year filter dropdown -->
                        <select name="year" class="form-control mb-3" id="year" style="background-color: white;">
                            <option value="">Select Year</option>
                            {% for year in year_search %}
                            <option value="{{ year }}" {% if year == request.GET.year %}selected{% endif %}>{{ year }}</option>
                            {% endfor %}
                        </select>

                        <!-- Type of car filter -->
                        <select name="type" class="form-control mb-3" id="type" style="background-color: white;">
                            <option value="">Select Type of Car</option>
                            {% for style in body_style_search %}
                            <option value="{{ style }}" {% if style == request.GET.type %}selected{% endif %}>{{ style }}</option>
                            {% endfor %}
                        </select>

                        <!-- Price range slider -->
                        <div class="mb-3">
                            <label>Price</label>
                            <input type="range" name="price" class="form-range slider-custom" min="0" max="150000" value="{{ request.GET.price|default:0 }}" id="priceSlider">
                            <div class="price-display">
                                <span id="priceValue">{{ request.GET.price|default:0 }}</span> USD
                            </div>
                        </div>

                        <style>
                            .slider-custom {
                                width: 100%; /* Make the slider the same width as other form elements */
                                margin: 10px 0;
                            }

                            .price-display {
                                text-align: center;
                                margin-top: 5px;
                            }
                        </style>

                        <script>
                            const priceSlider = document.getElementById('priceSlider');
                            const priceValue = document.getElementById('priceValue');

                            priceSlider.addEventListener('input', function() {
                                priceValue.textContent = priceSlider.value;
                            });
                        </script>

                        <!-- Submit button -->
                        <button class="btn btn-danger w-100"><i class="fa fa-search" aria-hidden="true"></i> SEARCH</button>
                    </form>
                </div>

                <!-- Follow Us Section -->
                <div class="follow-us mt-4">
                    <h5>Follow us</h5>
                    <div class="d-flex">
                        <a href="#" class="btn btn-primary btn-sm mx-1"><i class="fa fa-facebook"></i></a>
                        <a href="#" class="btn btn-info btn-sm mx-1"><i class="fa fa-twitter"></i></a>
                        <a href="#" class="btn btn-danger btn-sm mx-1"><i class="fa fa-google-plus"></i></a>
                        <a href="#" class="btn btn-warning btn-sm mx-1"><i class="fa fa-rss"></i></a>
                        <a href="#" class="btn btn-info btn-sm mx-1"><i class="fa fa-linkedin"></i></a>
                        <style>
                            .btn-sm {
                                padding: 5px 10px;
                                font-size: 14px;
                                height: auto;
                            }
                        </style>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Cars Listing end -->

{% endblock %}